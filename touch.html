<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>3. Hybrid Mass Detect</title>
    <style>
        body { margin: 0; overflow: hidden; background: #333; }
        canvas { display: block; width: 100%; height: 100%; }
    </style>
</head>
<body>
    <canvas id="c"></canvas>
    <script>
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');
        
        // Resize
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        function render(e) {
            e.preventDefault();
            ctx.clearRect(0,0,canvas.width, canvas.height);

            let x, y, size, type;

            // SCENARIO A: 2 Fingers (Mimicking a fat brush)
            if (e.touches.length === 2) {
                const t1 = e.touches[0];
                const t2 = e.touches[1];

                // Calculate midpoint
                x = (t1.clientX + t2.clientX) / 2;
                y = (t1.clientY + t2.clientY) / 2;

                // Calculate distance between fingers
                const dist = Math.hypot(t2.clientX - t1.clientX, t2.clientY - t1.clientY);
                
                // Size is based on how far apart fingers are
                size = dist; 
                type = "2-Finger Merge";
            } 
            // SCENARIO B: 1 Finger (Checking for fat squish)
            else if (e.touches.length === 1) {
                const t1 = e.touches[0];
                x = t1.clientX;
                y = t1.clientY;
                
                // Size is based on contact radius
                size = (t1.radiusX || 20) * 2; 
                type = "1-Finger Radius";
            } 
            else {
                return; // 0 or >2 fingers
            }

            // Draw the visualizer
            ctx.beginPath();
            ctx.arc(x, y, size, 0, Math.PI*2);
            
            // Color logic: bigger = hotter color
            if (size < 30) ctx.fillStyle = '#4ade80'; // Green (Small)
            else if (size < 60) ctx.fillStyle = '#facc15'; // Yellow (Med)
            else ctx.fillStyle = '#ef4444'; // Red (Fat)
            
            ctx.fill();

            // Text info
            ctx.fillStyle = "white";
            ctx.font = "20px monospace";
            ctx.fillText(type, x - 50, y - size - 10);
            ctx.fillText(`Size: ${Math.round(size)}`, x - 30, y - size - 35);
        }

        window.addEventListener('touchstart', render, {passive: false});
        window.addEventListener('touchmove', render, {passive: false});
        window.addEventListener('touchend', (e) => {
            if(e.touches.length === 0) ctx.clearRect(0,0,canvas.width, canvas.height);
        });
    </script>
</body>
</html>
